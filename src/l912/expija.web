@* expija.
\section*{\sf Dummy Arguments}  \begin{description}
                                                                    
\item[PASSED:] IBUC1                                                     
\item[PASSED:] IBUC2                                                     
\item[INPUT:] NO                                                        
\item[INPUT:] NTIMES                                                    
                                                                    
\end{description} \section*{\sf Common Variables}  \begin{description}
                                                                    
\item[Modifies]    V                                                      
\item[Uses]  MDV     V       ZERO                                   
                                                                    
\end{description}  \section*{\sf External Subprograms}  \begin{description}
                                                                    
\item[Calls]       FILEIO  TRACK                                          
\item[Called by]    NOTHING                                           
                                                                    
\end{description}
@a
      subroutine expija(IBUC1,IBUC2,NO,NTIMES)
      implicit none
      double precision F42 , Four , Half , One , Onept5 , Ten , Three , 
     &                 Two , V , Zero
      integer i , IBUC1 , IBUC2 , icore , ii , ij , imj , In , indi , 
     &        indj , indrd , Iout , Ipunch , isave , ist , kount , 
     &        ktimes , leng , Mdv , NO
      integer NTIMES
      common /v     / V(20000) , Mdv
      common /const / Zero , Half , One , Onept5 , Two , Three , Four , 
     &                Ten , F42
      common /io    / In , Iout , Ipunch
C
C     ******************************************************************
C
C     expands matrix with i.lt.j,ab to all i,j,ab
C     no is the dimension of i or j, ntimes the dimension of ab.
C
C     june 79/krishnan
C
C     ******************************************************************
C
C
      call track('EXPIJA')
C
      if ( NO.gt.0 .and. NTIMES.gt.0 ) then
         call fileio(1,-IBUC2,0,0,0)
         icore = 0
C
         do 50 ii = 1 , NO
            indi = (ii-1)*(2*NO-ii)/2
C
            do 20 ij = 1 , NO
               indj = (ij-1)*(2*NO-ij)/2
               isave = icore
               icore = icore + NTIMES
               if ( icore.gt.Mdv ) then
C
                  leng = isave
                  call fileio(1,IBUC2,leng,V,0)
                  icore = NTIMES
                  isave = 0
               endif
C
               imj = ii - ij
               if ( imj.lt.0 ) then
C
C     check to see if the input is contiguous.
                  if ( ij.lt.NO .and. (icore+NTIMES).le.Mdv ) then
C
                     kount = kount + 1
                  else
                     ktimes = kount*NTIMES
                     indrd = (indi+ij-ii-1)*NTIMES - ktimes
                     leng = NTIMES + ktimes
                     call fileio(2,-IBUC1,leng,V(isave-ktimes+1),indrd)
                     kount = 0
                  endif
               elseif ( imj.eq.0 ) then
C
                  ist = isave + 1
                  do 5 i = ist , icore
                     V(i) = Zero
 5                continue
               else
C
                  indrd = (indj+ii-ij-1)*NTIMES
                  leng = NTIMES
                  call fileio(2,-IBUC1,leng,V(isave+1),indrd)
                  ist = isave + 1
                  do 10 i = ist , icore
                     V(i) = -V(i)
 10               continue
               endif
C
 20         continue
 50      continue
C
         leng = icore
         call fileio(1,IBUC2,leng,V,0)
      endif
C
      return
C
      end
@* INDEX.
