@* center.
\section*{\sf Dummy Arguments}  \begin{description}
                                                                    
\item[INPUT:] MAXAP3                                                    
\item[INPUT:] NATOMS                                                    
\item[INPUT:] A                                                         
\item[INPUT:] ATMCHG                                                    
\item[OUTPUT:] V                                                         
                                                                    
\end{description} \section*{\sf Common Variables}  \begin{description}
                                                                    
\item[Modifies]     NOTHING                                           
\item[Uses]   NOTHING                                           
                                                                    
\end{description}  \section*{\sf External Subprograms}  \begin{description}
                                                                    
\item[Calls]        NOTHING                                           
\item[Called by]   PTGRP                                                  
                                                                    
\end{description}
@a
      subroutine center(MAXAP3,NATOMS,A,ATMCHG,V)
      implicit none
      double precision A , ATMCHG , totwt , V , wt , zero
      integer i , iat , MAXAP3 , NATOMS
      dimension A(MAXAP3,3) , ATMCHG(*) , V(3)
      data zero/0.0D0/
C
C
C     calculate the position of the center of charge and return it
C     in v.
C
C
C
C
      do 100 i = 1 , 3
         V(i) = zero
 100  continue
      totwt = zero
C
      do 200 iat = 1 , NATOMS
         wt = ATMCHG(iat)
         totwt = totwt + wt
         V(1) = V(1) + wt*A(iat,1)
         V(2) = V(2) + wt*A(iat,2)
         V(3) = V(3) + wt*A(iat,3)
 200  continue
C
      V(1) = V(1)/totwt
      V(2) = V(2)/totwt
      V(3) = V(3)/totwt
      return
C
      end
@* INDEX.
