#if(0)
  FTANGLE v1.61,
 created with UNIX on "Friday, September 25, 1998 at 8:02." 
  COMMAND LINE: "ftangle -ybs15000 rot2"
  RUN TIME:     "Friday, June 5, 2009 at 15:05."
  WEB FILE:     "rot2.web"
  CHANGE FILE:  (none) 
#endif


      subroutine rot2
      implicit none
      double precision Cosp , G0000 , G0001 , G0002 , G0003 , G0011 ,
     &                 G0012 , G0013 , G0022 , G0023 , G0033 , G0100 ,
     &                 G0101 , G0102 , G0103 , G0111 , G0112 , G0113 ,
     &                 G0122 , G0123
      double precision G0133 , G0200 , G0201 , G0202 , G0203 , G0211 ,
     &                 G0212 , G0213 , G0222 , G0223 , G0233 , G0300 ,
     &                 G0301 , G0302 , G0303 , G0311 , G0312 , G0313 ,
     &                 G0322 , G0323
      double precision G0333 , G1000 , G1001 , G1002 , G1003 , G1011 ,
     &                 G1012 , G1013 , G1022 , G1023 , G1033 , G1100 ,
     &                 G1101 , G1102 , G1103 , G1111 , G1112 , G1113 ,
     &                 G1122 , G1123
      double precision G1133 , G1200 , G1201 , G1202 , G1203 , G1211 ,
     &                 G1212 , G1213 , G1222 , G1223 , G1233 , G1300 ,
     &                 G1301 , G1302 , G1303 , G1311 , G1312 , G1313 ,
     &                 G1322 , G1323
      double precision G1333 , G2000 , G2001 , G2002 , G2003 , G2011 ,
     &                 G2012 , G2013 , G2022 , G2023 , G2033 , G2100 ,
     &                 G2101 , G2102 , G2103 , G2111 , G2112 , G2113 ,
     &                 G2122 , G2123
      double precision G2133 , G2200 , G2201 , G2202 , G2203 , G2211 ,
     &                 G2212 , G2213 , G2222 , G2223 , G2233 , G2300 ,
     &                 G2301 , G2302 , G2303 , G2311 , G2312 , G2313 ,
     &                 G2322 , G2323
      double precision G2333 , G3000 , G3001 , G3002 , G3003 , G3011 ,
     &                 G3012 , G3013 , G3022 , G3023 , G3033 , G3100 ,
     &                 G3101 , G3102 , G3103 , G3111 , G3112 , G3113 ,
     &                 G3122 , G3123
      double precision G3133 , G3200 , G3201 , G3202 , G3203 , G3211 ,
     &                 G3212 , G3213 , G3222 , G3223 , G3233 , G3300 ,
     &                 G3301 , G3302 , G3303 , G3311 , G3312 , G3313 ,
     &                 G3322 , G3323
      double precision G3333 , H0000 , H0001 , H0002 , H0003 , H0011 ,
     &                 H0012 , H0013 , H0022 , H0023 , H0033 , H0100 ,
     &                 H0101 , H0102 , H0103 , H0111 , H0112 , H0113 ,
     &                 H0122 , H0123
      double precision H0133 , H0200 , H0201 , H0202 , H0203 , H0211 ,
     &                 H0212 , H0213 , H0222 , H0223 , H0233 , H0300 ,
     &                 H0301 , H0302 , H0303 , H0311 , H0312 , H0313 ,
     &                 H0322 , H0323
      double precision H0333 , H1000 , H1001 , H1002 , H1003 , H1011 ,
     &                 H1012 , H1013 , H1022 , H1023 , H1033 , H1100 ,
     &                 H1101 , H1102 , H1103 , H1111 , H1112 , H1113 ,
     &                 H1122 , H1123
      double precision H1133 , H1200 , H1201 , H1202 , H1203 , H1211 ,
     &                 H1212 , H1213 , H1222 , H1223 , H1233 , H1300 ,
     &                 H1301 , H1302 , H1303 , H1311 , H1312 , H1313 ,
     &                 H1322 , H1323
      double precision H1333 , H2000 , H2001 , H2002 , H2003 , H2011 ,
     &                 H2012 , H2013 , H2022 , H2023 , H2033 , H2100 ,
     &                 H2101 , H2102 , H2103 , H2111 , H2112 , H2113 ,
     &                 H2122 , H2123
      double precision H2133 , H2200 , H2201 , H2202 , H2203 , H2211 ,
     &                 H2212 , H2213 , H2222 , H2223 , H2233 , H2300 ,
     &                 H2301 , H2302 , H2303 , H2311 , H2312 , H2313 ,
     &                 H2322 , H2323
      double precision H2333 , H3000 , H3001 , H3002 , H3003 , H3011 ,
     &                 H3012 , H3013 , H3022 , H3023 , H3033 , H3100 ,
     &                 H3101 , H3102 , H3103 , H3111 , H3112 , H3113 ,
     &                 H3122 , H3123
      double precision H3133 , H3200 , H3201 , H3202 , H3203 , H3211 ,
     &                 H3212 , H3213 , H3222 , H3223 , H3233 , H3300 ,
     &                 H3301 , H3302 , H3303 , H3311 , H3312 , H3313 ,
     &                 H3322 , H3323
      double precision H3333 , one , Sinp , U11 , u12 , U21 , U22 ,
     &                 V11 , v12 , V21 , V22 , v44 , v45 , v47 , v54 ,
     &                 v55 , v57 , v74 , v77 , zero
      integer Mab , Mcd , Ngangb
      common /misc  / Mab , Mcd , Ngangb
      common /phi   / Cosp , Sinp
      common /g     / G0000 , G0001 , G0002 , G0003 , G0011 , G0012 ,
     &                G0013 , G0022 , G0023 , G0033 , G0100 , G0101 ,
     &                G0102 , G0103 , G0111 , G0112 , G0113 , G0122 ,
     &                G0123 , G0133 , G0200 , G0201 , G0202 , G0203 ,
     &                G0211 , G0212 , G0213 , G0222 , G0223 , G0233 ,
     &                G0300 , G0301 , G0302 , G0303 , G0311 , G0312 ,
     &                G0313 , G0322 , G0323 , G0333 , G1000 , G1001 ,
     &                G1002 , G1003 , G1011 , G1012 , G1013 , G1022 ,
     &                G1023 , G1033 , G1100 , G1101 , G1102 , G1103 ,
     &                G1111 , G1112 , G1113 , G1122 , G1123 , G1133 ,
     &                G1200 , G1201 , G1202 , G1203 , G1211 , G1212 ,
     &                G1213 , G1222 , G1223 , G1233 , G1300 , G1301 ,
     &                G1302 , G1303 , G1311 , G1312 , G1313 , G1322 ,
     &                G1323 , G1333 , G2000 , G2001 , G2002 , G2003 ,
     &                G2011 , G2012 , G2013 , G2022 , G2023 , G2033 ,
     &                G2100 , G2101 , G2102 , G2103 , G2111 , G2112 ,
     &                G2113 , G2122 , G2123 , G2133 , G2200 , G2201 ,
     &                G2202 , G2203 , G2211 , G2212 , G2213 , G2222 ,
     &                G2223 , G2233 , G2300 , G2301 , G2302 , G2303 ,
     &                G2311 , G2312 , G2313 , G2322 , G2323 , G2333 ,
     &                G3000 , G3001 , G3002 , G3003 , G3011 , G3012 ,
     &                G3013 , G3022 , G3023 , G3033 , G3100 , G3101 ,
     &                G3102 , G3103 , G3111 , G3112 , G3113 , G3122 ,
     &                G3123 , G3133 , G3200 , G3201 , G3202 , G3203 ,
     &                G3211 , G3212 , G3213 , G3222 , G3223 , G3233 ,
     &                G3300 , G3301 , G3302 , G3303 , G3311 , G3312 ,
     &                G3313 , G3322 , G3323 , G3333
      common /h     / H0000 , H0001 , H0002 , H0003 , H0011 , H0012 ,
     &                H0013 , H0022 , H0023 , H0033 , H0100 , H0101 ,
     &                H0102 , H0103 , H0111 , H0112 , H0113 , H0122 ,
     &                H0123 , H0133 , H0200 , H0201 , H0202 , H0203 ,
     &                H0211 , H0212 , H0213 , H0222 , H0223 , H0233 ,
     &                H0300 , H0301 , H0302 , H0303 , H0311 , H0312 ,
     &                H0313 , H0322 , H0323 , H0333 , H1000 , H1001 ,
     &                H1002 , H1003 , H1011 , H1012 , H1013 , H1022 ,
     &                H1023 , H1033 , H1100 , H1101 , H1102 , H1103 ,
     &                H1111 , H1112 , H1113 , H1122 , H1123 , H1133 ,
     &                H1200 , H1201 , H1202 , H1203 , H1211 , H1212 ,
     &                H1213 , H1222 , H1223 , H1233 , H1300 , H1301 ,
     &                H1302 , H1303 , H1311 , H1312 , H1313 , H1322 ,
     &                H1323 , H1333 , H2000 , H2001 , H2002 , H2003 ,
     &                H2011 , H2012 , H2013 , H2022 , H2023 , H2033 ,
     &                H2100 , H2101 , H2102 , H2103 , H2111 , H2112 ,
     &                H2113 , H2122 , H2123 , H2133 , H2200 , H2201 ,
     &                H2202 , H2203 , H2211 , H2212 , H2213 , H2222 ,
     &                H2223 , H2233 , H2300 , H2301 , H2302 , H2303 ,
     &                H2311 , H2312 , H2313 , H2322 , H2323 , H2333 ,
     &                H3000 , H3001 , H3002 , H3003 , H3011 , H3012 ,
     &                H3013 , H3022 , H3023 , H3033 , H3100 , H3101 ,
     &                H3102 , H3103 , H3111 , H3112 , H3113 , H3122 ,
     &                H3123 , H3133 , H3200 , H3201 , H3202 , H3203 ,
     &                H3211 , H3212 , H3213 , H3222 , H3223 , H3233 ,
     &                H3300 , H3301 , H3302 , H3303 , H3311 , H3312 ,
     &                H3313 , H3322 , H3323 , H3333
      equivalence (U11,Cosp)
      equivalence (U22,Cosp)
      equivalence (U21,Sinp)
      equivalence (V11,U11)
      equivalence (v12,u12)
      equivalence (V21,U21)
      equivalence (V22,U22)
      data zero/0.0D0/ , one/1.0D0/
C
C
C     no rotation if abcd coplanar
      if ( Sinp.eq.0 ) then
         if ( Cosp.lt.0 ) then
C
            if ( Mab.lt.0 ) goto 1000
            if ( Mab.ne.0 ) then
               G1000 = -H1000
               G1001 = H1001
               G1002 = zero
               G1003 = -H1003
               G1011 = -H1011
               G1012 = zero
               G1013 = H1013
               G1022 = -H1022
               G1023 = zero
               G1033 = -H1033
               G1100 = H1100
               G1101 = -H1101
               G1102 = zero
               G1103 = H1103
               G1111 = H1111
               G1112 = zero
               G1113 = -H1113
               G1122 = H1122
               G1123 = zero
               G1133 = H1133
               G1200 = zero
               G1201 = zero
               G1202 = -H1202
               G1203 = zero
               G1211 = zero
               G1212 = H1212
               G1213 = zero
               G1222 = zero
               G1223 = -H1223
               G1233 = zero
               G1300 = -H1300
               G1301 = H1301
               G1302 = zero
               G1303 = -H1303
               G1311 = -H1311
               G1312 = zero
               G1313 = H1313
               G1322 = -H1322
               G1323 = zero
               G1333 = -H1333
               G2000 = zero
               G2001 = zero
               G2002 = H2002
               G2003 = zero
               G2011 = zero
               G2012 = -H2012
               G2013 = zero
               G2022 = zero
               G2023 = H2023
               G2033 = zero
               G2100 = zero
               G2101 = zero
               G2102 = -H2102
               G2103 = zero
               G2111 = zero
               G2112 = H2112
               G2113 = zero
               G2122 = zero
               G2123 = -H2123
               G2133 = zero
               G2200 = H2200
               G2201 = -H2201
               G2202 = zero
               G2203 = H2203
               G2211 = H2211
               G2212 = zero
               G2213 = -H2213
               G2222 = H2222
               G2223 = zero
               G2233 = H2233
               G2300 = zero
               G2301 = zero
               G2302 = H2302
               G2303 = zero
               G2311 = zero
               G2312 = -H2312
               G2313 = zero
               G2322 = zero
               G2323 = H2323
               G2333 = zero
               G3000 = H3000
               G3001 = -H3001
               G3002 = zero
               G3003 = H3003
               G3011 = H3011
               G3012 = zero
               G3013 = -H3013
               G3022 = H3022
               G3023 = zero
               G3033 = H3033
               G3100 = -H3100
               G3101 = H3101
               G3102 = zero
               G3103 = -H3103
               G3111 = -H3111
               G3112 = zero
               G3113 = H3113
               G3122 = -H3122
               G3123 = zero
               G3133 = -H3133
               G3200 = zero
               G3201 = zero
               G3202 = H3202
               G3203 = zero
               G3211 = zero
               G3212 = -H3212
               G3213 = zero
               G3222 = zero
               G3223 = H3223
               G3233 = zero
               G3300 = H3300
               G3301 = -H3301
               G3302 = zero
               G3303 = H3303
               G3311 = H3311
               G3312 = zero
               G3313 = -H3313
               G3322 = H3322
               G3323 = zero
               G3333 = H3333
            endif
            G0100 = -H0100
            G0101 = H0101
            G0102 = zero
            G0103 = -H0103
            G0111 = -H0111
C      write(6,*) ' h0111 used in rot2 ', h0111
            G0112 = zero
            G0113 = H0113
            G0122 = -H0122
            G0123 = zero
            G0133 = -H0133
            G0200 = zero
            G0201 = zero
            G0202 = H0202
            G0203 = zero
            G0211 = zero
            G0212 = -H0212
            G0213 = zero
            G0222 = zero
            G0223 = H0223
            G0233 = zero
            G0300 = H0300
            G0301 = -H0301
            G0302 = zero
            G0303 = H0303
            G0311 = H0311
            G0312 = zero
            G0313 = -H0313
            G0322 = H0322
            G0323 = zero
            G0333 = H0333
            goto 1000
         elseif ( Cosp.ne.0 ) then
C
            if ( Mab.lt.0 ) goto 20
            if ( Mab.ne.0 ) then
               G1000 = H1000
               G1001 = H1001
               G1002 = zero
               G1003 = H1003
               G1011 = H1011
               G1012 = zero
               G1013 = H1013
               G1022 = H1022
               G1023 = zero
               G1033 = H1033
               G1100 = H1100
               G1101 = H1101
               G1102 = zero
               G1103 = H1103
               G1111 = H1111
               G1112 = zero
               G1113 = H1113
               G1122 = H1122
               G1123 = zero
               G1133 = H1133
               G1200 = zero
               G1201 = zero
               G1202 = H1202
               G1203 = zero
               G1211 = zero
               G1212 = H1212
               G1213 = zero
               G1222 = zero
               G1223 = H1223
               G1233 = zero
               G1300 = H1300
               G1301 = H1301
               G1302 = zero
               G1303 = H1303
               G1311 = H1311
               G1312 = zero
               G1313 = H1313
               G1322 = H1322
               G1323 = zero
               G1333 = H1333
               G2000 = zero
               G2001 = zero
               G2002 = H2002
               G2003 = zero
               G2011 = zero
               G2012 = H2012
               G2013 = zero
               G2022 = zero
               G2023 = H2023
               G2033 = zero
               G2100 = zero
               G2101 = zero
               G2102 = H2102
               G2103 = zero
               G2111 = zero
               G2112 = H2112
               G2113 = zero
               G2122 = zero
               G2123 = H2123
               G2133 = zero
               G2200 = H2200
               G2201 = H2201
               G2202 = zero
               G2203 = H2203
               G2211 = H2211
               G2212 = zero
               G2213 = H2213
               G2222 = H2222
               G2223 = zero
               G2233 = H2233
               G2300 = zero
               G2301 = zero
               G2302 = H2302
               G2303 = zero
               G2311 = zero
               G2312 = H2312
               G2313 = zero
               G2322 = zero
               G2323 = H2323
               G2333 = zero
               G3000 = H3000
               G3001 = H3001
               G3002 = zero
               G3003 = H3003
               G3011 = H3011
               G3012 = zero
               G3013 = H3013
               G3022 = H3022
               G3023 = zero
               G3033 = H3033
               G3100 = H3100
               G3101 = H3101
               G3102 = zero
               G3103 = H3103
               G3111 = H3111
               G3112 = zero
               G3113 = H3113
               G3122 = H3122
               G3123 = zero
               G3133 = H3133
               G3200 = zero
               G3201 = zero
               G3202 = H3202
               G3203 = zero
               G3211 = zero
               G3212 = H3212
               G3213 = zero
               G3222 = zero
               G3223 = H3223
               G3233 = zero
               G3300 = H3300
               G3301 = H3301
               G3302 = zero
               G3303 = H3303
               G3311 = H3311
               G3312 = zero
               G3313 = H3313
               G3322 = H3322
               G3323 = zero
               G3333 = H3333
            endif
            G0100 = H0100
            G0101 = H0101
            G0102 = zero
            G0103 = H0103
            G0111 = H0111
            G0112 = zero
            G0113 = H0113
            G0122 = H0122
            G0123 = zero
            G0133 = H0133
            G0200 = zero
            G0201 = zero
            G0202 = H0202
            G0203 = zero
            G0211 = zero
            G0212 = H0212
            G0213 = zero
            G0222 = zero
            G0223 = H0223
            G0233 = zero
            G0300 = H0300
            G0301 = H0301
            G0302 = zero
            G0303 = H0303
            G0311 = H0311
            G0312 = zero
            G0313 = H0313
            G0322 = H0322
            G0323 = zero
            G0333 = H0333
 20         G0000 = H0000
            G0001 = H0001
            G0002 = zero
            G0003 = H0003
            G0011 = H0011
            G0012 = zero
            G0013 = H0013
            G0022 = H0022
            G0023 = zero
            G0033 = H0033
            return
         endif
      endif
      u12 = -Sinp
      if ( Mcd.gt.0 ) then
         v44 = V11*V11
         v77 = v44
         v47 = one - v44
         v74 = v47
         v54 = V11*V21
         v57 = -v54
         v45 = v57 + v57
         v55 = v44 - v47
      endif
      if ( Mcd.lt.0 ) goto 200
      if ( Mcd.ne.0 ) then
         if ( Mab.lt.0 ) goto 50
         if ( Mab.ne.0 ) then
            G1011 = v44*H1011 + v47*H1022
            G1012 = v54*H1011 + v57*H1022
            G1022 = v74*H1011 + v77*H1022
            G1013 = V11*H1013
            G1023 = V21*H1013
            G1033 = H1033
            G1111 = v44*H1111 + v47*H1122
            G1112 = v54*H1111 + v57*H1122
            G1122 = v74*H1111 + v77*H1122
            G1113 = V11*H1113
            G1123 = V21*H1113
            G1133 = H1133
            G1211 = v45*H1212
            G1212 = v55*H1212
            G1222 = -G1211
            G1213 = v12*H1223
            G1223 = V22*H1223
            G1233 = zero
            G1311 = v44*H1311 + v47*H1322
            G1312 = v54*H1311 + v57*H1322
            G1322 = v74*H1311 + v77*H1322
            G1313 = V11*H1313
            G1323 = V21*H1313
            G1333 = H1333
            G2011 = v45*H2012
            G2012 = v55*H2012
            G2022 = -G2011
            G2013 = v12*H2023
            G2023 = V22*H2023
            G2033 = zero
            G2111 = v45*H2112
            G2112 = v55*H2112
            G2122 = -G2111
            G2113 = v12*H2123
            G2123 = V22*H2123
            G2133 = zero
            G2211 = v44*H2211 + v47*H2222
            G2212 = v54*H2211 + v57*H2222
            G2222 = v74*H2211 + v77*H2222
            G2213 = V11*H2213
            G2223 = V21*H2213
            G2233 = H2233
            G2311 = v45*H2312
            G2312 = v55*H2312
            G2322 = -G2311
            G2313 = v12*H2323
            G2323 = V22*H2323
            G2333 = zero
            G3011 = v44*H3011 + v47*H3022
            G3012 = v54*H3011 + v57*H3022
            G3022 = v74*H3011 + v77*H3022
            G3013 = V11*H3013
            G3023 = V21*H3013
            G3033 = H3033
            G3111 = v44*H3111 + v47*H3122
            G3112 = v54*H3111 + v57*H3122
            G3122 = v74*H3111 + v77*H3122
            G3113 = V11*H3113
            G3123 = V21*H3113
            G3133 = H3133
            G3211 = v45*H3212
            G3212 = v55*H3212
            G3222 = -G3211
            G3213 = v12*H3223
            G3223 = V22*H3223
            G3233 = zero
            G3311 = v44*H3311 + v47*H3322
            G3312 = v54*H3311 + v57*H3322
            G3322 = v74*H3311 + v77*H3322
            G3313 = V11*H3313
            G3323 = V21*H3313
            G3333 = H3333
         endif
         G0111 = v44*H0111 + v47*H0122
         G0112 = v54*H0111 + v57*H0122
         G0122 = v74*H0111 + v77*H0122
         G0113 = V11*H0113
         G0123 = V21*H0113
         G0133 = H0133
         G0211 = v45*H0212
         G0212 = v55*H0212
         G0222 = -G0211
         G0213 = v12*H0223
         G0223 = V22*H0223
         G0233 = zero
         G0311 = v44*H0311 + v47*H0322
         G0312 = v54*H0311 + v57*H0322
         G0322 = v74*H0311 + v77*H0322
         G0313 = V11*H0313
         G0323 = V21*H0313
         G0333 = H0333
 50      G0011 = v44*H0011 + v47*H0022
         G0012 = v54*H0011 + v57*H0022
         G0022 = v74*H0011 + v77*H0022
         G0013 = V11*H0013
         G0023 = V21*H0013
         G0033 = H0033
      endif
      if ( Mab.lt.0 ) goto 100
      if ( Mab.ne.0 ) then
         G1001 = V11*H1001
         G1002 = V21*H1001
         G1003 = H1003
         G1101 = V11*H1101
         G1102 = V21*H1101
         G1103 = H1103
         G1201 = v12*H1202
         G1202 = V22*H1202
         G1203 = zero
         G1301 = V11*H1301
         G1302 = V21*H1301
         G1303 = H1303
         G2001 = v12*H2002
         G2002 = V22*H2002
         G2003 = zero
         G2101 = v12*H2102
         G2102 = V22*H2102
         G2103 = zero
         G2201 = V11*H2201
         G2202 = V21*H2201
         G2203 = H2203
         G2301 = v12*H2302
         G2302 = V22*H2302
         G2303 = zero
         G3001 = V11*H3001
         G3002 = V21*H3001
         G3003 = H3003
         G3101 = V11*H3101
         G3102 = V21*H3101
         G3103 = H3103
         G3201 = v12*H3202
         G3202 = V22*H3202
         G3203 = zero
         G3301 = V11*H3301
         G3302 = V21*H3301
         G3303 = H3303
      endif
      G0101 = V11*H0101
      G0102 = V21*H0101
      G0103 = H0103
      G0201 = v12*H0202
      G0202 = V22*H0202
      G0203 = zero
      G0301 = V11*H0301
      G0302 = V21*H0301
      G0303 = H0303
 100  G0001 = V11*H0001
      G0002 = V21*H0001
      G0003 = H0003
 200  if ( Mab.lt.0 ) goto 300
      if ( Mab.ne.0 ) then
         G1000 = H1000
         G1100 = H1100
         G1200 = zero
         G1300 = H1300
         G2000 = zero
         G2100 = zero
         G2200 = H2200
         G2300 = zero
         G3000 = H3000
         G3100 = H3100
         G3200 = zero
         G3300 = H3300
      endif
      G0100 = H0100
      G0200 = zero
      G0300 = H0300
 300  G0000 = H0000
      if ( Mcd.lt.0 ) goto 500
      if ( Mcd.ne.0 ) then
         if ( Mab.lt.0 ) goto 350
         if ( Mab.ne.0 ) then
            H1011 = U11*G1011 + u12*G2011
            H1012 = U11*G1012 + u12*G2012
            H1013 = U11*G1013 + u12*G2013
            H1022 = U11*G1022 + u12*G2022
            H1023 = U11*G1023 + u12*G2023
            H1033 = U11*G1033 + u12*G2033
            H1111 = U11*G1111 + u12*G2111
            H1112 = U11*G1112 + u12*G2112
            H1113 = U11*G1113 + u12*G2113
            H1122 = U11*G1122 + u12*G2122
            H1123 = U11*G1123 + u12*G2123
            H1133 = U11*G1133 + u12*G2133
            H1211 = U11*G1211 + u12*G2211
            H1212 = U11*G1212 + u12*G2212
            H1213 = U11*G1213 + u12*G2213
            H1222 = U11*G1222 + u12*G2222
            H1223 = U11*G1223 + u12*G2223
            H1233 = U11*G1233 + u12*G2233
            H1311 = U11*G1311 + u12*G2311
            H1312 = U11*G1312 + u12*G2312
            H1313 = U11*G1313 + u12*G2313
            H1322 = U11*G1322 + u12*G2322
            H1323 = U11*G1323 + u12*G2323
            H1333 = U11*G1333 + u12*G2333
            H2011 = U21*G1011 + U22*G2011
            H2012 = U21*G1012 + U22*G2012
            H2013 = U21*G1013 + U22*G2013
            H2022 = U21*G1022 + U22*G2022
            H2023 = U21*G1023 + U22*G2023
            H2033 = U21*G1033 + U22*G2033
            H2111 = U21*G1111 + U22*G2111
            H2112 = U21*G1112 + U22*G2112
            H2113 = U21*G1113 + U22*G2113
            H2122 = U21*G1122 + U22*G2122
            H2123 = U21*G1123 + U22*G2123
            H2133 = U21*G1133 + U22*G2133
            H2211 = U21*G1211 + U22*G2211
            H2212 = U21*G1212 + U22*G2212
            H2213 = U21*G1213 + U22*G2213
            H2222 = U21*G1222 + U22*G2222
            H2223 = U21*G1223 + U22*G2223
            H2233 = U21*G1233 + U22*G2233
            H2311 = U21*G1311 + U22*G2311
            H2312 = U21*G1312 + U22*G2312
            H2313 = U21*G1313 + U22*G2313
            H2322 = U21*G1322 + U22*G2322
            H2323 = U21*G1323 + U22*G2323
            H2333 = U21*G1333 + U22*G2333
            H3011 = G3011
            H3012 = G3012
            H3013 = G3013
            H3022 = G3022
            H3023 = G3023
            H3033 = G3033
            H3111 = G3111
            H3112 = G3112
            H3113 = G3113
            H3122 = G3122
            H3123 = G3123
            H3133 = G3133
            H3211 = G3211
            H3212 = G3212
            H3213 = G3213
            H3222 = G3222
            H3223 = G3223
            H3233 = G3233
            H3311 = G3311
            H3312 = G3312
            H3313 = G3313
            H3322 = G3322
            H3323 = G3323
            H3333 = G3333
         endif
         H0111 = G0111
         H0112 = G0112
         H0113 = G0113
         H0122 = G0122
         H0123 = G0123
         H0133 = G0133
         H0211 = G0211
         H0212 = G0212
         H0213 = G0213
         H0222 = G0222
         H0223 = G0223
         H0233 = G0233
         H0311 = G0311
         H0312 = G0312
         H0313 = G0313
         H0322 = G0322
         H0323 = G0323
         H0333 = G0333
 350     H0011 = G0011
         H0012 = G0012
         H0013 = G0013
         H0022 = G0022
         H0023 = G0023
         H0033 = G0033
      endif
      if ( Mab.lt.0 ) goto 400
      if ( Mab.ne.0 ) then
         H1001 = U11*G1001 + u12*G2001
         H1002 = U11*G1002 + u12*G2002
         H1003 = U11*G1003 + u12*G2003
         H1101 = U11*G1101 + u12*G2101
         H1102 = U11*G1102 + u12*G2102
         H1103 = U11*G1103 + u12*G2103
         H1201 = U11*G1201 + u12*G2201
         H1202 = U11*G1202 + u12*G2202
         H1203 = U11*G1203 + u12*G2203
         H1301 = U11*G1301 + u12*G2301
         H1302 = U11*G1302 + u12*G2302
         H1303 = U11*G1303 + u12*G2303
         H2001 = U21*G1001 + U22*G2001
         H2002 = U21*G1002 + U22*G2002
         H2003 = U21*G1003 + U22*G2003
         H2101 = U21*G1101 + U22*G2101
         H2102 = U21*G1102 + U22*G2102
         H2103 = U21*G1103 + U22*G2103
         H2201 = U21*G1201 + U22*G2201
         H2202 = U21*G1202 + U22*G2202
         H2203 = U21*G1203 + U22*G2203
         H2301 = U21*G1301 + U22*G2301
         H2302 = U21*G1302 + U22*G2302
         H2303 = U21*G1303 + U22*G2303
         H3001 = G3001
         H3002 = G3002
         H3003 = G3003
         H3101 = G3101
         H3102 = G3102
         H3103 = G3103
         H3201 = G3201
         H3202 = G3202
         H3203 = G3203
         H3301 = G3301
         H3302 = G3302
         H3303 = G3303
      endif
      H0101 = G0101
      H0102 = G0102
      H0103 = G0103
      H0201 = G0201
      H0202 = G0202
      H0203 = G0203
      H0301 = G0301
      H0302 = G0302
      H0303 = G0303
 400  H0001 = G0001
      H0002 = G0002
      H0003 = G0003
 500  if ( Mab.lt.0 ) goto 600
      if ( Mab.ne.0 ) then
         H1000 = U11*G1000 + u12*G2000
         H1100 = U11*G1100 + u12*G2100
         H1200 = U11*G1200 + u12*G2200
         H1300 = U11*G1300 + u12*G2300
         H2000 = U21*G1000 + U22*G2000
         H2100 = U21*G1100 + U22*G2100
         H2200 = U21*G1200 + U22*G2200
         H2300 = U21*G1300 + U22*G2300
         H3000 = G3000
         H3100 = G3100
         H3200 = G3200
         H3300 = G3300
      endif
      H0100 = G0100
      H0200 = G0200
      H0300 = G0300
 600  H0000 = G0000
C
      if ( Mcd.lt.0 ) goto 800
      if ( Mcd.ne.0 ) then
         if ( Mab.lt.0 ) goto 650
         if ( Mab.ne.0 ) then
            G1011 = H1011
            G1012 = H1012
            G1013 = H1013
            G1022 = H1022
            G1023 = H1023
            G1033 = H1033
            G1111 = U11*H1111 + u12*H1211
            G1112 = U11*H1112 + u12*H1212
            G1113 = U11*H1113 + u12*H1213
            G1122 = U11*H1122 + u12*H1222
            G1123 = U11*H1123 + u12*H1223
            G1133 = U11*H1133 + u12*H1233
            G1211 = U21*H1111 + U22*H1211
            G1212 = U21*H1112 + U22*H1212
            G1213 = U21*H1113 + U22*H1213
            G1222 = U21*H1122 + U22*H1222
            G1223 = U21*H1123 + U22*H1223
            G1233 = U21*H1133 + U22*H1233
            G1311 = H1311
            G1312 = H1312
            G1313 = H1313
            G1322 = H1322
            G1323 = H1323
            G1333 = H1333
            G2011 = H2011
            G2012 = H2012
            G2013 = H2013
            G2022 = H2022
            G2023 = H2023
            G2033 = H2033
            G2111 = U11*H2111 + u12*H2211
            G2112 = U11*H2112 + u12*H2212
            G2113 = U11*H2113 + u12*H2213
            G2122 = U11*H2122 + u12*H2222
            G2123 = U11*H2123 + u12*H2223
            G2133 = U11*H2133 + u12*H2233
            G2211 = U21*H2111 + U22*H2211
            G2212 = U21*H2112 + U22*H2212
            G2213 = U21*H2113 + U22*H2213
            G2222 = U21*H2122 + U22*H2222
            G2223 = U21*H2123 + U22*H2223
            G2233 = U21*H2133 + U22*H2233
            G2311 = H2311
            G2312 = H2312
            G2313 = H2313
            G2322 = H2322
            G2323 = H2323
            G2333 = H2333
            G3011 = H3011
            G3012 = H3012
            G3013 = H3013
            G3022 = H3022
            G3023 = H3023
            G3033 = H3033
            G3111 = U11*H3111 + u12*H3211
            G3112 = U11*H3112 + u12*H3212
            G3113 = U11*H3113 + u12*H3213
            G3122 = U11*H3122 + u12*H3222
            G3123 = U11*H3123 + u12*H3223
            G3133 = U11*H3133 + u12*H3233
            G3211 = U21*H3111 + U22*H3211
            G3212 = U21*H3112 + U22*H3212
            G3213 = U21*H3113 + U22*H3213
            G3222 = U21*H3122 + U22*H3222
            G3223 = U21*H3123 + U22*H3223
            G3233 = U21*H3133 + U22*H3233
            G3311 = H3311
            G3312 = H3312
            G3313 = H3313
            G3322 = H3322
            G3323 = H3323
            G3333 = H3333
         endif
         G0111 = U11*H0111 + u12*H0211
         G0112 = U11*H0112 + u12*H0212
         G0113 = U11*H0113 + u12*H0213
         G0122 = U11*H0122 + u12*H0222
         G0123 = U11*H0123 + u12*H0223
         G0133 = U11*H0133 + u12*H0233
         G0211 = U21*H0111 + U22*H0211
         G0212 = U21*H0112 + U22*H0212
         G0213 = U21*H0113 + U22*H0213
         G0222 = U21*H0122 + U22*H0222
         G0223 = U21*H0123 + U22*H0223
         G0233 = U21*H0133 + U22*H0233
         G0311 = H0311
         G0312 = H0312
         G0313 = H0313
         G0322 = H0322
         G0323 = H0323
         G0333 = H0333
 650     G0011 = H0011
         G0012 = H0012
         G0013 = H0013
         G0022 = H0022
         G0023 = H0023
         G0033 = H0033
      endif
      if ( Mab.lt.0 ) goto 700
      if ( Mab.ne.0 ) then
         G1001 = H1001
         G1002 = H1002
         G1003 = H1003
         G1101 = U11*H1101 + u12*H1201
         G1102 = U11*H1102 + u12*H1202
         G1103 = U11*H1103 + u12*H1203
         G1201 = U21*H1101 + U22*H1201
         G1202 = U21*H1102 + U22*H1202
         G1203 = U21*H1103 + U22*H1203
         G1301 = H1301
         G1302 = H1302
         G1303 = H1303
         G2001 = H2001
         G2002 = H2002
         G2003 = H2003
         G2101 = U11*H2101 + u12*H2201
         G2102 = U11*H2102 + u12*H2202
         G2103 = U11*H2103 + u12*H2203
         G2201 = U21*H2101 + U22*H2201
         G2202 = U21*H2102 + U22*H2202
         G2203 = U21*H2103 + U22*H2203
         G2301 = H2301
         G2302 = H2302
         G2303 = H2303
         G3001 = H3001
         G3002 = H3002
         G3003 = H3003
         G3101 = U11*H3101 + u12*H3201
         G3102 = U11*H3102 + u12*H3202
         G3103 = U11*H3103 + u12*H3203
         G3201 = U21*H3101 + U22*H3201
         G3202 = U21*H3102 + U22*H3202
         G3203 = U21*H3103 + U22*H3203
         G3301 = H3301
         G3302 = H3302
         G3303 = H3303
      endif
      G0101 = U11*H0101 + u12*H0201
      G0102 = U11*H0102 + u12*H0202
      G0103 = U11*H0103 + u12*H0203
      G0201 = U21*H0101 + U22*H0201
      G0202 = U21*H0102 + U22*H0202
      G0203 = U21*H0103 + U22*H0203
      G0301 = H0301
      G0302 = H0302
      G0303 = H0303
 700  G0001 = H0001
      G0002 = H0002
      G0003 = H0003
 800  if ( Mab.lt.0 ) goto 900
      if ( Mab.ne.0 ) then
         G1000 = H1000
         G1100 = U11*H1100 + u12*H1200
         G1200 = U21*H1100 + U22*H1200
         G1300 = H1300
         G2000 = H2000
         G2100 = U11*H2100 + u12*H2200
         G2200 = U21*H2100 + U22*H2200
         G2300 = H2300
         G3000 = H3000
         G3100 = U11*H3100 + u12*H3200
         G3200 = U21*H3100 + U22*H3200
         G3300 = H3300
      endif
      G0100 = U11*H0100 + u12*H0200
      G0200 = U21*H0100 + U22*H0200
      G0300 = H0300
 900  G0000 = H0000
      return
 1000 G0000 = H0000
      G0001 = -H0001
      G0002 = zero
      G0003 = H0003
      G0011 = H0011
      G0012 = zero
      G0013 = -H0013
      G0022 = H0022
      G0023 = zero
      G0033 = H0033
      return
C
      end

