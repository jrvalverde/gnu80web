@*htype.
\section*{\sf Dummy Arguments}  \begin{description}

\item[OUTPUT:] HYB
\item[INPUT:] LTYP
\item[INPUT:] MXAO
\item[INPUT:] NH
\item[OUTPUT:] COEF
\item[OUTPUT:] PCT
\item[OUTPUT:] NL
\item[INPUT:] ISGN

\end{description} \section*{\sf Common Variables}  \begin{description}

\item[Modifies]     NOTHING 
\item[Uses]  LFNPR

\end{description}  \section*{\sf External Subprograms}  \begin{description}

\item[Calls]        NOTHING 
\item[Called by]   ANLYZE  XCITED

\end{description}
@a
C*****************************************************************************
      subroutine htype(HYB,LTYP,MXAO,NH,COEF,PCT,NL,ISGN)
C*****************************************************************************
      implicit none
      double precision COEF , hundrd , HYB , PCT , thresh , zero
      integer i , ISGN , l1 , Lfnao , Lfnarc , Lfndaf , Lfndef , Lfndm ,
     &        Lfnin , Lfnmo , Lfnnab , Lfnnao , Lfnnbo , Lfnnho ,
     &        Lfnnlm , Lfnpna , Lfnpnb , Lfnpnh , Lfnpnl , Lfnppa
      integer Lfnpr , LTYP , MXAO , NH , NL
      dimension HYB(MXAO) , LTYP(MXAO) , PCT(5)
      common /nbio  / Lfnin , Lfnpr , Lfnao , Lfnpna , Lfnnao , Lfnpnh ,
     &                Lfnnho , Lfnpnb , Lfnnbo , Lfnpnl , Lfnnlm ,
     &                Lfnmo , Lfndm , Lfnnab , Lfnppa , Lfnarc ,
     &                Lfndaf , Lfndef
C
C  analyze input hybrid 'hyb' for polarization coefficient 'coef'
C  and percentages of each angular momentum component.
C
      data zero , thresh , hundrd/0.0D0 , 1.D-4 , 100.0D0/
C
      NL = 0
C
C  zero percentages and polarization coefficient:
C
      do 100 l1 = 1 , 5
         PCT(l1) = zero
 100  continue
      COEF = zero
C
C  loop over atomic contributions to hybrid, computing percentages
C  and polarization coefficient:
C
      do 200 i = 1 , NH
         l1 = LTYP(i) + 1
         if ( l1.gt.5 ) goto 600
         PCT(l1) = PCT(l1) + HYB(i)**2
         COEF = COEF + HYB(i)**2
 200  continue
      if ( dabs(COEF).lt.thresh ) return
C
C  calculate percentage contribution for each angular symmetry:
C
      do 300 l1 = 1 , 5
         PCT(l1) = PCT(l1)/COEF*hundrd
 300  continue
      COEF = dsqrt(COEF)
C
C  switch the sign of the coefficient if isgn is negative:
C
      if ( ISGN.lt.0 ) COEF = -COEF
C
C  normalize the hybrid:
C
      do 400 i = 1 , NH
         HYB(i) = HYB(i)/COEF
 400  continue
C
C  find the maximum number of angular momentum types (nl):
C
      do 500 i = 1 , NH
         if ( dabs(HYB(i)).ge.thresh ) then
            if ( LTYP(i).gt.NL ) NL = LTYP(i)
         endif
 500  continue
      NL = NL + 1
      return
C
 600  write (Lfnpr,99001) l1 - 1
      stop
C
99001 format (/1x,'AO with unknown angular symmetry, l = ',i3)
      end
@* INDEX.
